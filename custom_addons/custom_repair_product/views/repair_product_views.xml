<odoo>
    <!-- Vista tipo lista: movimientos ligados a órdenes de reparación -->
    <record id="view_stock_move_repair_list" model="ir.ui.view">
        <field name="name">stock.move.repair.list</field>
        <field name="model">stock.move</field>
        <field name="arch" type="xml">
            <list string="Productos en reparaciones" create="false" delete="false">
                <field name="repair_state" invisible="1" />
                <field name="repair_id"/>
                <field name="product_id"/>
                <field name="product_uom_qty"/>
                <field name="quantity"/>
                <field name="repair_line_type"/>
                <field name="forecast_availability"/>
                <field name="picked"/>
                <button type="object" name="action_product_forecast_report" title="Forecast Report" icon="fa-area-chart" column_invisible="repair_state != 'draft'" invisible="forecast_availability &lt; 0 and repair_line_type == 'add'"/>
                <button type="object" name="action_product_forecast_report" title="Forecast Report" icon="fa-area-chart text-danger" column_invisible="repair_state != 'draft'" invisible="forecast_availability &gt;= 0 or repair_line_type != 'add'"/>
                <field name="forecast_availability" string="Forecasted" column_invisible="repair_state in ('draft', 'done')" widget="forecast_widget"/>
            </list>
        </field>
    </record>

    <!-- Acción de ventana -->
    <record id="action_stock_move_repair_list" model="ir.actions.act_window">
        <field name="name">Productos en Reparaciones</field>
        <field name="res_model">stock.move</field>
        <field name="view_mode">list</field>
        <field name="view_id" ref="view_stock_move_repair_list"/>
        <field name="domain">[('repair_id', '!=', False)]</field>
        <field name="help" type="html">
            <p>Aquí puedes consultar todos los productos que se han añadido o retirado en las órdenes de reparación.</p>
        </field>
    </record>

    <!-- Menú bajo Reparaciones -->
    <menuitem id="menu_stock_move_repair_list"
              name="Productos en Reparaciones"
              parent="repair.menu_repair_order"
              action="action_stock_move_repair_list"
              sequence="50"/>
</odoo>
