<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_worksheet_generic">
        <t t-call="web.html_container">
          <t t-foreach="docs" t-as="doc">
            <div class="page">
              <h2>Hoja de Trabajo â€” <t t-esc="doc.display_name"/></h2>
    
              <t t-foreach="doc._fields.items()" t-as="it">
                <t t-set="name" t-value="it[0]"/>
                <t t-set="f" t-value="it[1]"/>
    
                <t t-if="name not in ('id','display_name','create_uid','create_date','write_uid','write_date')">
    
                  <!-- many2one -->
                  <t t-if="f.type == 'many2one'">
                    <p><strong><t t-esc="f.string or name"/>:</strong>
                      <t t-esc="(doc[name] and doc[name].display_name) or ''"/></p>
                  </t>
    
                  <!-- selection -->
                  <t t-elif="f.type == 'selection'">
                    <p><strong><t t-esc="f.string or name"/>:</strong>
                      <t t-esc="(dict(f.selection or [])).get(doc[name], '')"/></p>
                  </t>
    
                  <!-- binarios (firmas) -->
                  <t t-elif="f.type == 'binary' and ('sign' in name or 'firma' in name)">
                    <p><strong><t t-esc="f.string or name"/>:</strong></p>
                    <img t-if="doc[name]" t-att-src="'data:image/png;base64,%s' % doc[name]"
                        style="max-width:100%;max-height:250px;"/>
                  </t>
    
                  <!-- tipos simples -->
                  <t t-elif="f.type in ('char','text','html','float','integer','boolean','date','datetime')">
                    <p><strong><t t-esc="f.string or name"/>:</strong> <t t-esc="doc[name]"/></p>
                  </t>
    
                </t>
              </t>
            </div>
          </t>
        </t>
      </template>
    
    <record id="rule_worksheet_template_user_access" model="ir.rule">
        <field name="name">Worksheet Template full access for internal users</field>
        <field name="model_id" ref="worksheet.model_worksheet_template"/>
        <field name="domain_force">[(1,'=',1)]</field>
    </record>
</odoo>
