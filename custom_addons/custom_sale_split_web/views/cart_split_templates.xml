<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <template id="cart_lines_split" inherit_id="website_sale.cart_lines">
    <!-- Reemplaza SOLO el foreach interno -->
    <xpath expr="//div[@id='cart_products']//div[@t-foreach='website_sale_order.website_order_line' and @t-as='line']"
           position="replace">
      <t t-set="groups" t-value="website_sale_order._get_split_groups_for_website()"/>

      <t t-if="groups.get('maquinas') and groups['maquinas']">
        <h4 class="my-3">MÃ¡quinas</h4>
        <div t-foreach="groups['maquinas']" t-as="line"
             t-attf-class="o_cart_product d-flex align-items-stretch gap-3 #{not line_last and 'border-bottom pb-4'} #{line_index &gt; 0 and 'pt-4'}"
             t-attf-data-product-id="#{line.product_id and line.product_id.id}">
          <t t-call="website_sale.cart_line"/>
        </div>
      </t>

      <t t-if="groups.get('recambios') and groups['recambios']">
        <h4 class="my-3">Recambios</h4>
        <div t-foreach="groups['recambios']" t-as="line"
             t-attf-class="o_cart_product d-flex align-items-stretch gap-3 #{not line_last and 'border-bottom pb-4'} #{line_index &gt; 0 and 'pt-4'}"
             t-attf-data-product-id="#{line.product_id and line.product_id.id}">
          <t t-call="website_sale.cart_line"/>
        </div>
      </t>
    </xpath>
  </template>
</odoo>
